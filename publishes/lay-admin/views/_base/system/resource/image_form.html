<script type="text/html" template lay-done="layui.data.done(d.params)">
  <div class="layui-fluid">
    <div class="layui-form" lay-filter="form_image">
      <div class="layui-form-item">
        <label class="layui-form-label">关键字</label>
        <div class="layui-input-inline">
          <input type="hidden" name="id" value="{{d.params.id || ''}}"/>
          <input type="text" name="image_key" value="{{d.params.image_key || ''}}" lay-verify="required"
                 autocomplete="off"
                 class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">图片说明</label>
        <div class="layui-input-inline" style="width: 250px">
          <input type="text" name="intro" value="{{d.params.intro || ''}}" lay-verify="required" autocomplete="off"
                 class="layui-input">
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label form-required">封面图片</label>
        <div class="layui-input-inline">
          <div id="resource_image"></div>
        </div>
      </div>
      <div class="layui-form-item">
        <div class="layui-footer">
          <label class="layui-form-label"></label>
          <div class="layui-input-inline">
            <input type="button" lay-submit lay-filter="submit_image" value="确认" class="layui-btn">
          </div>
        </div>
      </div>
    </div>
  </div>
</script>

<script>
  layui.data.done = function (obj) {
    layui.use(['fox_upload'], function () {
      let admin = layui.admin
        , fox_upload = layui.fox_upload

      //设置当前页面的通用参数
      fox_upload.set({
        url: 'lay-admin/upload/resource/image'
        , headers: {
          Authorization: admin.getAccessToken('Bearer'),
        }
      })
      //上传控件初始化
      fox_upload.render({
        elem: '#resource_image'
        , name: 'image_url'
        , value: obj.image_url
      })
    })
  }
</script>
